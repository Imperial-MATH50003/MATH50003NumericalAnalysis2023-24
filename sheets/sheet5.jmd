**Numerical Analysis MATH50003 (2023â€“24) Problem Sheet 5**



**Problem 1(a)**  Suppose $|Ïµ_k| â‰¤ Ïµ$ and $n Ïµ < 1$. Use induction to show that
$$
âˆ_{k=1}^n (1+Ïµ_k) = 1+Î¸_n
$$
for some constant $Î¸_n$ satisfying
$$
|Î¸_n| â‰¤ \underbrace{n Ïµ \over 1-nÏµ}_{E_{n,Ïµ}}
$$




**Problem 1(b)** Show for an idealised floating point vector $ð± âˆˆ F_{âˆž,S}^n$ 
that
$$
x_1 âŠ• â‹¯ âŠ• x_n = x_1 +  â‹¯ + x_n + Ïƒ_n
$$
where
$$
|Ïƒ_n| â‰¤ \| ð± \|_âˆž E_{n-1,Ïµ_{\rm m}/2},
$$
assuming $n Ïµ_{\rm m} < 2$ and where $\|ð±\|_âˆž := \max_k |x_k|$.
Hint: use the previous part to first write
$$
x_1 âŠ• â‹¯ âŠ• x_n = x_1(1+Î¸_{n-1}) + âˆ‘_{j=2}^n x_j (1 + Î¸_{n-j+1}).
$$




**Problem 1(c)** For $A âˆˆ F_{âˆž,S}^{n Ã— n}$ and $ð± âˆˆ F_{âˆž,S}^n$ consider the error
in approximating matrix multiplication with idealised floating point: for
$$
A ð± =  \begin{pmatrix}
â¨_{j=1}^n A_{1,j} âŠ— x_j\\
â‹® \\
â¨_{j=1}^n A_{1,j} âŠ— x_j
\end{pmatrix} + Î´
$$
show that
$$
\| Î´ \|_âˆž â‰¤ 2 \|A\|_âˆž \| ð± \|_âˆž E_{n,Ïµ_{\rm m}/2}
$$
where  $n Ïµ_{\rm m} < 2$ and the matrix norm is $\|A \|_âˆž := \max_k âˆ‘_{j=1}^n |a_{kj}|$.





---------


**Problem 2** Derive  Backward Euler: use the left-sided divided difference approximation
$$
u'(x) â‰ˆ {u(x) - u(x-h)  \over h}
$$
to reduce the first order ODE
$$
\meeq{
u(a) =  c, \qquad u'(x) + Ï‰(x) u(x) = f(x)
}
$$
to a lower triangular system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$. Hint: only impose the ODE on the
gridpoints $x_1,â€¦,x_n$ so that the divided difference does not depend on behaviour at $x_{-1}$.


##Â SOLUTION

We have,
\begin{align*}
\frac{u_{k+1} - u_k}{h} \approx \frac{u'(x_{k+1}) + u'(x_k)}{2} = \frac{a(x_{k+1})u_{k+1} + a(x_{k})u_{k}}{2} + \frac{1}{2}(f(x_{k+1}) + f(x_k)),
\end{align*}
so we can write,
\begin{align*}
\left(\frac{1}{h} - \frac{a(x_{k+1})}{2}\right)u_{k+1} + \left(-\frac{1}{h} - \frac{a(x_{k})}{2}\right)u_k = \frac{1}{2}(f(x_{k+1}) + f(x_k)).
\end{align*}
With the initial condition $u(0) = c$, we can write the whole system as,
$$
\left[\begin{matrix}
1 \\
-\frac{1}{h} - \frac{a(x_1)}{2} && \frac{1}{h} - \frac{a(x_2)}{2} \\
& \ddots && \ddots \\
 & & -\frac{1}{h} - \frac{a(x_{n-1})}{2} && \frac{1}{h} - \frac{a(x_n)}{2}
\end{matrix}\right]\mathbf{u} =  \left[\begin{matrix} 
c \\
\frac{1}{2}\left(f(x_1) + f(x_2)\right) \\
\vdots \\
\frac{1}{2}\left(f(x_{n-1}) + f(x_n)\right)
\end{matrix}\right],
$$
which is lower bidiagonal.

Now if we wish to use forward substitution in a vector linear problem, we can derive in much the same way as above:
$$
\left(\frac{1}{h}I - \frac{A(x_{k+1})}{2}\right)\mathbf{u}_{k+1} + \left(-\frac{1}{h}I - \frac{A(x_{k})}{2}\right)\mathbf{u}_k = \frac{1}{2}(\mathbf{f}(x_{k+1}) + \mathbf{f}(x_k)),
$$
to make the update equation,
$$
\mathbf{u}_{k+1} = \left(I - \frac{h}{2}A(x_{k+1})\right)^{-1}\left(\left(I + \frac{h}{2}A(x_{k})\right)\mathbf{u}_k + \frac{h}{2}(\mathbf{f}(x_{k+1}) + \mathbf{f}(x_k)) \right),
$$
with initial value,
$$
\mathbf{u}_1 = \mathbf{c}.
$$


**Problem 3** Reduce a SchrÃ¶dinger equation to a tridiagonal linear system by discretising on the grid $x_j = a + j h$ for $h = (b-a)/n$:
$$
\meeq{
u(a) =  c,\qquad u''(x) + V(x) u(x) = f(x), \qquad u(b) = d.
}
$$